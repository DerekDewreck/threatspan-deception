{% extends "base.html" %}

{% block mainContent %}
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
    <div class="alert alert-{{category}} alert-dismissible fade show" role="alert">
      {{message}}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="row">
<div class="col-md-3"></div>
<div class="col-md-5">
  <div class="card">
    <div class="card-body login-card-body">
      <p class="login-box-msg">You are only one step a way from your new password, change your password now.</p>

      <form id="changepassword" action="#" method="post">
        <div class="form-group">
            <div class="input-group mb-3">
                <input id="password" type="password" class="form-control" name="password" placeholder="New Password" data-parsley-required-message="Password is required" required>
                <div class="input-group-append">
                    <div class="input-group-text">
                    <span class="fas fa-lock"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group mb-3">
                <input type="password" class="form-control" placeholder="Confirm New Password" data-parsley-equalto="#password" data-parsley-required-message="Password is required" data-parsley-equalto-message="Password does not match!" required>
                <div class="input-group-append">
                    <div class="input-group-text">
                    <span class="fas fa-lock"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
          <div class="col-4">
            <button type="submit" class="btn btn-primary btn-block">Change password</button>
          </div>
          <!-- /.col -->
        </div>
      </form>
    </div>
    <!-- /.login-card-body -->
  </div>
</div>
</div>
{% endblock %}
{% block script %}
<!-- parsley validator -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/parsley.js/2.9.2/parsley.min.js"></script>
<script>

  //FORM VALIDATION
  $(document).ready(function () {

    var parsleyConfig = {
        errorClass: 'has-danger',
        successClass: 'has-success',
        classHandler: function (field) {
            return field.$element.parents('.form-group');
        },
        errorsContainer: function (field) {
            return field.$element.parents('.form-group');
        },
        errorsWrapper: '<span class="form-text text-danger">',
        errorTemplate: '<div></div>'
      };

    // Activate parsley
    $('#changepassword').parsley(parsleyConfig);
  });

</script>
{% endblock %}